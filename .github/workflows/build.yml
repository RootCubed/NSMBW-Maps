name: Build symbol maps

on: [push]

permissions:
  contents: write

jobs:
    build_maps:
        runs-on: ubuntu-22.04
        steps:
            - name: Checkout repo
              uses: actions/checkout@v3

            - uses: actions/checkout@master
              with:
                repository: RoadrunnerWMC/wii-code-tools
                path: wii-code-tools

            - name: Setup python
              uses: actions/setup-python@v4
              with:
                python-version: '3.10'
                
            - name: Make symbol maps
              run: python build.py

            - name: Create zip artifact
              run: zip -r -j NSMBW_Symbol_Maps.zip maps

            - name: Create release
              uses: ncipollo/release-action@v1
              with:
                allowUpdates: true
                tag: 'v1.0'
                name: 'Autogenerated symbol maps'
                artifacts: ./NSMBW_Symbol_Maps.zip
